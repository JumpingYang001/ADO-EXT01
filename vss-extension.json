{
  "manifestVersion": 1,
  "id": "cascading-multiselect",
  "version": "1.0.84",
  "name": "Cascading Multi-Select",
  "scopes": ["vso.work", "vso.work_write"],
  "description": "A configurable cascading multi-selection control for Azure DevOps work items",
  "publisher": "PDETs-test1",
  "categories": ["Azure Boards"],
  "targets": [
    {
      "id": "Microsoft.VisualStudio.Services"
    }
  ],
  "icons": {
    "default": "images/logo.png"
  },
  "contributions": [
    {
      "id": "cascading-multiselect-control-v2",
      "type": "ms.vss-work-web.work-item-form-control",
      "description": "Cascading multi-selection control for work items",
      "targets": [
        "ms.vss-work-web.work-item-form"
      ],
      "properties": {
        "name": "Cascading Multi-Select",
        "uri": "dist/CascadingMultiSelect.html",
        "height": 300,
        "supportedDataTypes": ["String"],
        "canSortBy": false,
        "inputs": [
          {
            "id": "FieldName",
            "name": "Field",
            "description": "The field associated with the control.",
            "type": "WorkItemField",
            "properties": {
              "workItemFieldTypes": ["String"]
            },
            "validation": {
              "dataType": "String",
              "isRequired": true
            }
          },
          {
            "id": "parentSelectMode",
            "name": "Parent Selection Mode",
            "description": "Whether parent items are selectable (true) or only child items (false)",
            "type": "boolean",
            "validation": {
              "dataType": "Boolean",
              "isRequired": false
            }
          },
          {
            "id": "fieldValues",
            "name": "Field Values",
            "description": "JSON configuration for hierarchical data",
            "type": "string",
            "validation": {
              "dataType": "String",
              "isRequired": true
            }
          },
          {
            "id": "multiSelectSeparator",
            "name": "Multi-Select Separator",
            "description": "Separator for multiple selected values",
            "type": "string",
            "validation": {
              "dataType": "String",
              "isRequired": false
            }
          }
        ]
      }
    },
    {
      "id": "identity-multiselect-control",
      "type": "ms.vss-work-web.work-item-form-control",
      "description": "Multi-selection control for identity fields (users and groups)",
      "targets": [
        "ms.vss-work-web.work-item-form"
      ],
      "properties": {
        "name": "Identity Multi-Select",
        "uri": "dist/IdentityMultiSelect.html",
        "height": 130,
        "supportedDataTypes": ["String", "Identity"],
        "canSortBy": false,
        "inputs": [
          {
            "id": "FieldName",
            "name": "Storage Field (Multi-line Text)",
            "description": "The multi-line text field to store the selected identities (one per line).",
            "type": "WorkItemField",
            "properties": {
              "workItemFieldTypes": ["Html", "String"]
            },
            "validation": {
              "dataType": "String",
              "isRequired": true
            }
          },
          {
            "id": "identitySourceField",
            "name": "Identity Source Field",
            "description": "An Identity field to use as the picker source (provides native Azure DevOps identity picker UI).",
            "type": "WorkItemField",
            "properties": {
              "workItemFieldTypes": ["Identity","String"]
            },
            "validation": {
              "isRequired": true
            }
          },
          {
            "id": "maxSelections",
            "name": "Maximum Selections",
            "description": "Maximum number of identities that can be selected (default: 10)",
            "type": "string",
            "validation": {
              "dataType": "String",
              "isRequired": false
            }
          },
          {
            "id": "allowGroups",
            "name": "Allow Groups",
            "description": "Whether to allow selection of groups in addition to users (default: true)",
            "type": "boolean",
            "validation": {
              "dataType": "Boolean",
              "isRequired": false
            }
          },
          {
            "id": "separator",
            "name": "Legacy Separator (Deprecated)",
            "description": "Legacy option for backward compatibility. New installations use multi-line format.",
            "type": "string",
            "validation": {
              "dataType": "String",
              "isRequired": false
            }
          }
        ]
      }
    }
  ],
  "files": [
    {
      "path": "dist",
      "addressable": true
    },
    {
      "path": "images",
      "addressable": true
    }
  ]
}
